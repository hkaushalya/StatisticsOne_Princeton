{
    "contents" : "# Statistics One, 2013, Lab 10\n\n# Lab goals\n#   Conduct a binary logisitc regression \n\n# Example\n# The data are based on a mock jury study conducted by Shari Diamond and Jonathan Casper \n# Participants (N = 100) watched a videotaped sentencing phase trial in which the defendant had \n#   already been found guilty  \n# The issue for the jurors to decide was whether the defendant deserved the death penalty  \n# These data were collected “pre-deliberation” (i.e., each juror was asked to provide \n#   his/her vote on the death penalty verdict, then the jurors met as a group to decide the \n#   overall jury verdict)\n# The initial individual verdicts are given in this data set\n\n# Check your working directory\n# getwd()\n# If necessary, set your working directory\n# setwd(\"/Volumes/Conway/R\")\n\n# If necessary, install packages\n# install.packages(\"psych\")\n# install.packages(\"aod\")\n# install.packages(\"QuantPsyc\")\n\n# Load packages\nlibrary(psych)\nlibrary(aod)\nlibrary(QuantPsyc)\n\n# Read the data into a dataframe called BL\nBL <- read.table(\"Stats1.13.Lab.10.txt\", header = T)\n\n# If you want to view the data\n# View(BL)\nedit(BL)\n\n# Summary statistics\ndescribe(BL) \n\n# Binary logistic regression\nlrfit <- glm(BL$verdict ~ BL$danger + BL$rehab + BL$punish + BL$gendet + BL$specdet + BL$incap, family = binomial)\nsummary(lrfit)\n\nconfint(lrfit) # CIs using profiled log-likelihood (default for logistic models)\nconfint.default(lrfit) # CIs using standard errors\n\n# Model fit\nwith(lrfit, null.deviance - deviance) #difference in deviance for the two models\nwith(lrfit, df.null - df.residual) #df for the difference between the two models\nwith(lrfit, pchisq(null.deviance-deviance, df.null-df.residual, lower.tail = FALSE)) #p-value\n\n# Wald tests\nlibrary(aod)\nwald.test(b = coef(lrfit), Sigma = vcov(lrfit), Terms = 2) #danger\nwald.test(b = coef(lrfit), Sigma = vcov(lrfit), Terms = 3) #rehab\nwald.test(b = coef(lrfit), Sigma = vcov(lrfit), Terms = 4) #punish\nwald.test(b = coef(lrfit), Sigma = vcov(lrfit), Terms = 5) #gendet\nwald.test(b = coef(lrfit), Sigma = vcov(lrfit), Terms = 6) #specdet\nwald.test(b = coef(lrfit), Sigma = vcov(lrfit), Terms = 7) #incap\n\n# Odds ratios\nexp(coef(lrfit)) #exponentiated coefficients\n\n# Classification table\nClassLog(lrfit, BL$verdict)\n\n# Significant predictors (danger, rehab, gendet)\npar(mfrow=c(1,3))\nplot(BL$danger, predict(lrfit), bty=\"n\")\nabline(lm(predict(lrfit) ~ BL$danger), col=\"blue\", lwd=5)\nplot(BL$rehab, predict(lrfit), bty=\"n\")\nabline(lm(predict(lrfit) ~ BL$rehab), col=\"blue\", lwd=5)\nplot(BL$gendet, predict(lrfit), bty=\"n\")\nabline(lm(predict(lrfit) ~ BL$gendet), col=\"blue\", lwd=5)\npar(mfrow=c(1,1))\ntitle(\"Significant predictors\")\n\n# Non-significant predictors (punish, specdet, incap)\npar(mfrow=c(1,3))\nplot(BL$punish, predict(lrfit), bty=\"n\")\nabline(lm(predict(lrfit) ~ BL$punish), col=\"blue\", lwd=5)\nplot(BL$specdet, predict(lrfit), bty=\"n\")\nabline(lm(predict(lrfit) ~ BL$specdet), col=\"blue\", lwd=5)\nplot(BL$incap, predict(lrfit), bty=\"n\")\nabline(lm(predict(lrfit) ~ BL$incap), col=\"blue\", lwd=5)\npar(mfrow=c(1,1))\ntitle(\"Non-significant predictors\")\n",
    "created" : 1386013401749.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1528757693",
    "id" : "D4B7315A",
    "lastKnownWriteTime" : 1386013373,
    "path" : "~/Documents/Personal/Samantha/LearningMaterials/OnlineCourses_Coursera/StatisticsOne_Princeton/Week10Quiz/supplemental_Stats1.13.Lab.10.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}